{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/xlugx/work/project-crm/client/src/components/history/index.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport Layout from '../layout/Layout';\nimport Loader from '../loader/Loader';\nimport AuditLog from './AuditLog';\nimport { useRequest } from '../../hooks/request.hook';\n\nconst History = () => {\n  _s();\n\n  const {\n    request\n  } = useRequest(),\n        [transactions, update] = useState([]),\n        [list, setList] = useState(transactions),\n        [filter, setFilter] = useState({}),\n        [fetching, setFetching] = useState(false);\n  const getData = useCallback(async () => {\n    setFetching(true);\n    const {\n      res\n    } = await request('/api/transactions');\n    setFetching(false);\n    res && update(res.reverse());\n  }, [request]);\n  useEffect(() => {\n    getData();\n  }, []);\n  useEffect(() => {\n    setList(transactions);\n  }, [transactions]);\n  useEffect(() => {\n    let result = [...transactions];\n\n    if (filter['changed.type'] && filter['changed.type'] !== 'all') {\n      result = result.filter(({\n        changed\n      }) => changed.type === filter['changed.type']);\n    }\n\n    ;\n    setList(result);\n  }, [filter]);\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F \\u0438\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0439\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(AuditLog.Filter, {\n      filter: filter,\n      setFilter: setFilter\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 9\n    }, this), fetching && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 22\n    }, this), !fetching && list.length > 0 && /*#__PURE__*/_jsxDEV(AuditLog, {\n      children: list.map(({\n        _id: id,\n        changed,\n        authorId,\n        createdAt\n      }) => /*#__PURE__*/_jsxDEV(AuditLog.Item, {\n        id: id,\n        changed: changed,\n        authorId: authorId,\n        createdAt: createdAt\n      }, id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 70\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 42\n    }, this), !fetching && list.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"\\u0414\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u044B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 44\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 12\n  }, this);\n};\n\n_s(History, \"gyO/S+u4hsFDExcCcE97mXV1BZU=\", false, function () {\n  return [useRequest];\n});\n\n_c = History;\nexport default History;\n\nvar _c;\n\n$RefreshReg$(_c, \"History\");","map":{"version":3,"sources":["/home/xlugx/work/project-crm/client/src/components/history/index.jsx"],"names":["React","useState","useEffect","useCallback","Layout","Loader","AuditLog","useRequest","History","request","transactions","update","list","setList","filter","setFilter","fetching","setFetching","getData","res","reverse","result","changed","type","length","map","_id","id","authorId","createdAt"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,WAArC,QAAwD,OAAxD;AACA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,SAASC,UAAT,QAA2B,0BAA3B;;AAGA,MAAMC,OAAO,GAAG,MAAM;AAAA;;AAClB,QAAM;AAAEC,IAAAA;AAAF,MAAcF,UAAU,EAA9B;AAAA,QACI,CAACG,YAAD,EAAeC,MAAf,IAAyBV,QAAQ,CAAC,EAAD,CADrC;AAAA,QAEI,CAACW,IAAD,EAAOC,OAAP,IAAkBZ,QAAQ,CAACS,YAAD,CAF9B;AAAA,QAGI,CAACI,MAAD,EAASC,SAAT,IAAsBd,QAAQ,CAAC,EAAD,CAHlC;AAAA,QAII,CAACe,QAAD,EAAWC,WAAX,IAA0BhB,QAAQ,CAAC,KAAD,CAJtC;AAMA,QAAMiB,OAAO,GAAGf,WAAW,CAAC,YAAY;AACpCc,IAAAA,WAAW,CAAC,IAAD,CAAX;AAEA,UAAM;AAAEE,MAAAA;AAAF,QAAU,MAAMV,OAAO,CAAC,mBAAD,CAA7B;AAEAQ,IAAAA,WAAW,CAAC,KAAD,CAAX;AAEAE,IAAAA,GAAG,IAAIR,MAAM,CAACQ,GAAG,CAACC,OAAJ,EAAD,CAAb;AACH,GAR0B,EAQxB,CAACX,OAAD,CARwB,CAA3B;AAWAP,EAAAA,SAAS,CAAC,MAAM;AACZgB,IAAAA,OAAO;AACV,GAFQ,EAEN,EAFM,CAAT;AAIAhB,EAAAA,SAAS,CAAC,MAAM;AACZW,IAAAA,OAAO,CAACH,YAAD,CAAP;AACH,GAFQ,EAEN,CAACA,YAAD,CAFM,CAAT;AAIAR,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAImB,MAAM,GAAG,CAAC,GAAGX,YAAJ,CAAb;;AAEA,QAAII,MAAM,CAAC,cAAD,CAAN,IAA0BA,MAAM,CAAC,cAAD,CAAN,KAA2B,KAAzD,EAAgE;AAC5DO,MAAAA,MAAM,GAAGA,MAAM,CAACP,MAAP,CAAc,CAAC;AAAEQ,QAAAA;AAAF,OAAD,KAAiBA,OAAO,CAACC,IAAR,KAAiBT,MAAM,CAAC,cAAD,CAAtD,CAAT;AACH;;AAAA;AAEDD,IAAAA,OAAO,CAACQ,MAAD,CAAP;AACH,GARQ,EAQN,CAACP,MAAD,CARM,CAAT;AAYA,sBAAO,QAAC,MAAD;AAAA,4BACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADG,eAGH,QAAC,QAAD,CAAU,MAAV;AACI,MAAA,MAAM,EAAEA,MADZ;AAEI,MAAA,SAAS,EAAEC;AAFf;AAAA;AAAA;AAAA;AAAA,YAHG,EAQFC,QAAQ,iBAAI,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA,YARV,EAUF,CAACA,QAAD,IAAaJ,IAAI,CAACY,MAAL,GAAc,CAA3B,iBAAgC,QAAC,QAAD;AAAA,gBAC5BZ,IAAI,CAACa,GAAL,CAAS,CAAC;AAAEC,QAAAA,GAAG,EAAEC,EAAP;AAAWL,QAAAA,OAAX;AAAoBM,QAAAA,QAApB;AAA8BC,QAAAA;AAA9B,OAAD,kBAA+C,QAAC,QAAD,CAAU,IAAV;AAErD,QAAA,EAAE,EAAEF,EAFiD;AAGrD,QAAA,OAAO,EAAEL,OAH4C;AAIrD,QAAA,QAAQ,EAAEM,QAJ2C;AAKrD,QAAA,SAAS,EAAEC;AAL0C,SAChDF,EADgD;AAAA;AAAA;AAAA;AAAA,cAAxD;AAD4B;AAAA;AAAA;AAAA;AAAA,YAV9B,EAqBF,CAACX,QAAD,IAAaJ,IAAI,CAACY,MAAL,KAAgB,CAA7B,iBAAkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YArBhC;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AAwBH,CA9DD;;GAAMhB,O;UACkBD,U;;;KADlBC,O;AAgEN,eAAeA,OAAf","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport Layout from '../layout/Layout';\nimport Loader from '../loader/Loader';\nimport AuditLog from './AuditLog';\nimport { useRequest } from '../../hooks/request.hook';\n\n\nconst History = () => {\n    const { request } = useRequest(),\n        [transactions, update] = useState([]),\n        [list, setList] = useState(transactions),\n        [filter, setFilter] = useState({}),\n        [fetching, setFetching] = useState(false);\n\n    const getData = useCallback(async () => {\n        setFetching(true);\n\n        const { res } = await request('/api/transactions');\n\n        setFetching(false);\n\n        res && update(res.reverse());\n    }, [request]);\n\n\n    useEffect(() => {\n        getData();\n    }, []);\n\n    useEffect(() => {\n        setList(transactions);\n    }, [transactions]);\n\n    useEffect(() => {\n        let result = [...transactions];\n\n        if (filter['changed.type'] && filter['changed.type'] !== 'all') {\n            result = result.filter(({ changed }) => changed.type === filter['changed.type']);\n        };\n\n        setList(result);\n    }, [filter]);\n\n\n\n    return <Layout>\n        <h3>История изменений</h3>\n\n        <AuditLog.Filter\n            filter={filter}\n            setFilter={setFilter}\n        />\n\n        {fetching && <Loader />}\n\n        {!fetching && list.length > 0 && <AuditLog>\n            {list.map(({ _id: id, changed, authorId, createdAt }) => <AuditLog.Item\n                key={id}\n                id={id}\n                changed={changed}\n                authorId={authorId}\n                createdAt={createdAt}\n            />)}\n\n        </AuditLog>}\n\n        {!fetching && list.length === 0 && <div>Данные не найдены</div>}\n\n    </Layout>;\n};\n\nexport default History;"]},"metadata":{},"sourceType":"module"}